(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[289],{3612:function(e,t,s){Promise.resolve().then(s.bind(s,6031))},6031:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l}});var a=s(7437),n=s(2265);let i=[{id:"pending",label:"Awaiting Max",color:"border-[#fa5252]",icon:"⏳"},{id:"todo",label:"To Do",color:"border-[#fab005]",icon:"\uD83D\uDCCB"},{id:"inprogress",label:"In Progress",color:"border-[#5c7cfa]",icon:"\uD83D\uDD04"},{id:"done",label:"Done",color:"border-[#40c057]",icon:"✅"}];function l(){let[e,t]=(0,n.useState)([]),[s,l]=(0,n.useState)([{role:"assistant",content:"Hi! I'm Max. When you assign tasks to me, I'll: \n\n1️⃣ Review the task\n2️⃣ Ask clarifying questions if needed\n3️⃣ Wait for your confirmation\n4️⃣ Get to work!\n\nTry assigning a task to me! Tasks sync across all your devices."}]),[r,c]=(0,n.useState)(""),[d,o]=(0,n.useState)(!1),[x,u]=(0,n.useState)(!0),[m,p]=(0,n.useState)(null),[g,h]=(0,n.useState)(!1),[f,b]=(0,n.useState)(!1),y=(0,n.useRef)(null);(0,n.useRef)(null),(0,n.useEffect)(()=>{j()},[]);let j=async()=>{try{let e=await fetch("/api/tasks/get"),s=await e.json();s.success&&s.tasks&&(t(s.tasks),b(!0))}catch(s){console.error("Failed to fetch tasks:",s);let e=localStorage.getItem("maxmode-tasks-kanban");e&&(t(JSON.parse(e)),b(!1))}},D=async e=>{t(e);try{await fetch("/api/tasks/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tasks:e})}),b(!0)}catch(e){console.error("Failed to save to KV:",e)}localStorage.setItem("maxmode-tasks-kanban",JSON.stringify(e)),window.dispatchEvent(new Event("maxmode-task-changed"))},N=async e=>{try{let t="high"===e.priority?"\uD83D\uDD34":"medium"===e.priority?"\uD83D\uDFE1":"\uD83D\uDFE2",s=e.dueDate?"\n\uD83D\uDCC5 Due: ".concat(e.dueDate):"",a='\uD83E\uDD16 *New Task for Max*\n\n"'.concat(e.text,'"\n\n').concat(t," Priority: ").concat(e.priority).concat(s,"\n\uD83D\uDCC1 Category: ").concat(e.category,"\n\nClick ▶️ to start working on this task!"),n=await fetch("/api/telegram/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chatId:"8199918956",text:a,tasks:[e]})});(await n.json()).success&&h(!0)}catch(e){console.error("Telegram notification failed:",e)}},w=e=>{let t=e.toLowerCase(),s="General";for(let[e,a]of Object.entries({wedding:["wedding","bride","groom","venue","vendor","marriage"],business:["quote","invoice","client","lead","sale","proposal","contract"],marketing:["email","social","post","ad","campaign","content"],personal:["personal","family","friend","birthday"]}))if(a.some(e=>t.includes(e))){s=e.charAt(0).toUpperCase()+e.slice(1);break}let a="medium";t.includes("urgent")||t.includes("asap")||t.includes("important")||t.includes("!")?a="high":(t.includes("whenever")||t.includes("sometime"))&&(a="low");let n="julius";(t.includes("max")||t.includes("you"))&&(n="max");let i=null,l=new Date;if(t.includes("tomorrow")){let e=new Date(l);e.setDate(e.getDate()+1),i=e.toISOString().split("T")[0]}else if(t.includes("next week")){let e=new Date(l);e.setDate(e.getDate()+7),i=e.toISOString().split("T")[0]}else t.includes("today")&&(i=l.toISOString().split("T")[0]);let r=t.replace(/tomorrow/g,"").replace(/today/g,"").replace(/next week/g,"").replace(/urgent/g,"").replace(/asap/g,"").replace(/important/g,"").replace(/whenever/g,"").replace(/max/g,"").replace(/you/g,"").replace(/julius/g,"").replace(/remember to /g,"").replace(/remind me to /g,"").replace(/i need to /g,"").replace(/i should /g,"").replace(/can you /g,"").trim();return{text:(r=r.charAt(0).toUpperCase()+r.slice(1))||e,category:s,priority:a,assignee:n,dueDate:i}},v=t=>{let s={id:Date.now().toString()+Math.random().toString(36).substr(2,9),text:t.text||"",status:"max"===t.assignee?"pending":"todo",assignee:t.assignee||"julius",category:t.category||"General",priority:t.priority||"medium",dueDate:t.dueDate||null,createdAt:new Date().toISOString()};return D([s,...e]),"max"===s.assignee&&N(s),s},k=async t=>{if(t.preventDefault(),!r.trim()||d)return;let s=r.trim();c(""),l(e=>[...e,{role:"user",content:s}]),o(!0),await new Promise(e=>setTimeout(e,600));let a=e.find(e=>"max"===e.assignee&&"pending"===e.status);if(a){let t=s.toLowerCase();t.includes("go")||t.includes("yes")||t.includes("do it")||t.includes("proceed")||t.includes("confirmed")?(D(e.map(e=>e.id===a.id?{...e,status:"todo"}:e)),l(e=>[...e,{role:"assistant",content:"\uD83D\uDC4D Got it! Starting work on this task now.",taskId:a.id}]),p(a.id)):t.includes("cancel")||t.includes("nevermind")||t.includes("dont")||t.includes("stop")?(D(e.filter(e=>e.id!==a.id)),l(e=>[...e,{role:"assistant",content:"No problem! Task cancelled."}])):(D(e.map(e=>e.id===a.id?{...e,maxNotes:(e.maxNotes||"")+"\n"+s}:e)),l(e=>[...e,{role:"assistant",content:'Got it. Before I start, I have a question: What would you like me to do with this task? Say "go" to proceed or "cancel" to skip.',taskId:a.id}]))}else{let e=w(s);if(e&&e.text){let t=v(e);"max"===t.assignee?l(e=>[...e,{role:"assistant",content:"\uD83D\uDCCB I've noted the task: \"".concat(t.text,"\"\n\n\uD83D\uDCF1 I've sent this to your Telegram! Check your DM."),task:t}]):l(e=>[...e,{role:"assistant",content:'Created task: "'.concat(t.text,'"'),task:t}])}else l(e=>[...e,{role:"assistant",content:'I didn\'t understand. Try: "Follow up with bride tomorrow" or "Send quote to client"'}])}o(!1)},S=t=>{D(e.map(e=>e.id===t?{...e,status:"done"}:e)),l(e=>[...e,{role:"assistant",content:"✅ Task completed!"}]),p(null)},C=t=>e.filter(e=>e.status===t),T=(t,s)=>{D(e.map(e=>e.id===t?{...e,status:s}:e))},I=t=>{D(e.filter(e=>e.id!==t))},O=e=>{switch(e){case"high":return"bg-[#fa5252]/20 text-[#fa5252] border-[#fa5252]";case"medium":return"bg-[#fab005]/20 text-[#fab005] border-[#fab005]";case"low":return"bg-[#40c057]/20 text-[#40c057] border-[#40c057]";default:return"bg-[#2a2a2e] text-[#9a9a9e]"}},E=e=>{if(!e)return"";let t=new Date(e),s=new Date,a=new Date(s);return(a.setDate(a.getDate()+1),t.toDateString()===s.toDateString())?"Today":t.toDateString()===a.toDateString()?"Tomorrow":t.toLocaleDateString("en-US",{month:"short",day:"numeric"})},A=e.filter(e=>"max"===e.assignee&&"pending"===e.status),M=e.filter(e=>"max"===e.assignee&&"inprogress"===e.status);return(0,a.jsxs)("div",{className:"p-4 md:p-6",children:[(0,a.jsxs)("div",{className:"mb-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-white mb-1",children:"Tasks"}),(0,a.jsx)("p",{className:"text-[#9a9a9e]",children:"AI Assistant + Cloud Sync"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs ".concat(f?"bg-[#40c057]/20 text-[#40c057]":"bg-[#fab005]/20 text-[#fab005]"),children:[(0,a.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(f?"bg-[#40c057]":"bg-[#fab005]")}),f?"☁️ Synced":"\uD83D\uDCF1 Local only"]}),(0,a.jsx)("button",{onClick:()=>u(!x),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(x?"bg-[#5c7cfa] text-white":"bg-[#2a2a2e] text-[#9a9a9e]"),children:x?"\uD83D\uDCCB Board":"\uD83D\uDCAC Chat"})]})]}),x?(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"card p-4 flex flex-col h-[600px]",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4",children:[s.map((e,t)=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"max-w-[85%] rounded-lg p-3 ".concat("user"===e.role?"bg-[#5c7cfa] text-white":"bg-[#2a2a2e] text-white"),children:[(0,a.jsx)("p",{className:"whitespace-pre-line text-sm",children:e.content}),e.task&&"max"===e.task.assignee&&(0,a.jsxs)("div",{className:"mt-2 pt-2 border-t border-[#3a3a3e]",children:[(0,a.jsx)("p",{className:"text-xs opacity-70",children:"Assigned to Max"}),(0,a.jsx)("p",{className:"font-medium",children:e.task.text}),"pending"===e.task.status&&(0,a.jsx)("p",{className:"text-xs text-[#fab005] mt-1",children:"⏳ Check Telegram to start"})]}),e.taskId&&"assistant"===e.role&&e.content.includes("completed")&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("button",{onClick:()=>S(e.taskId),className:"w-full bg-[#40c057] hover:bg-[#37b24d] text-white py-2 rounded-lg text-sm font-medium transition-colors",children:"Mark Complete"})})]})},t)),d&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-[#2a2a2e] rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-[#9a9a9e] rounded-full animate-bounce"}),(0,a.jsx)("span",{className:"w-2 h-2 bg-[#9a9a9e] rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),(0,a.jsx)("span",{className:"w-2 h-2 bg-[#9a9a9e] rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})}),(0,a.jsx)("div",{ref:y})]}),(0,a.jsxs)("form",{onSubmit:k,className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:r,onChange:e=>c(e.target.value),placeholder:A.length>0?'Say "go" or ask a question...':"Describe a task...",className:"flex-1 bg-[#0d0d0f] border border-[#2a2a2e] rounded-lg px-4 py-3 text-white placeholder-[#9a9a9e] focus:outline-none focus:border-[#5c7cfa]"}),(0,a.jsx)("button",{type:"submit",disabled:d||!r.trim(),className:"bg-[#5c7cfa] hover:bg-[#4c6ef5] disabled:opacity-50 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"→"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:i.map(e=>(0,a.jsxs)("div",{className:"bg-[#161618] rounded-lg px-4 py-3 border-t-2 ".concat(e.color),children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-white",children:C(e.id).length}),(0,a.jsxs)("p",{className:"text-xs text-[#9a9a9e]",children:[e.icon," ",e.label]})]},e.id))}),A.length>0&&(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-[#fab005] mb-3",children:"\uD83E\uDD16 Max's Awaiting Tasks"}),(0,a.jsx)("div",{className:"space-y-2",children:A.map(e=>(0,a.jsxs)("div",{className:"bg-[#0d0d0f] rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-white text-sm",children:e.text}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded border ".concat(O(e.priority)),children:e.priority}),e.dueDate&&(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#2a2a2e]",children:E(e.dueDate)}),(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#fab005]/20 text-[#fab005]",children:"⏳ Pending"})]})]},e.id))})]}),M.length>0&&(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-[#5c7cfa] mb-3",children:"\uD83D\uDD04 Max Working On"}),(0,a.jsx)("div",{className:"space-y-2",children:M.map(e=>(0,a.jsxs)("div",{className:"bg-[#0d0d0f] rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-white text-sm",children:e.text}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded border ".concat(O(e.priority)),children:e.priority}),e.dueDate&&(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#2a2a2e]",children:E(e.dueDate)}),(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#5c7cfa]/20 text-[#5c7cfa]",children:"\uD83D\uDD04 In Progress"})]})]},e.id))})]}),(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-[#9a9a9e] mb-3",children:"Try saying:"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsx)("p",{className:"text-white bg-[#0d0d0f] px-3 py-2 rounded",children:'"Max, research wedding venues next week"'}),(0,a.jsx)("p",{className:"text-white bg-[#0d0d0f] px-3 py-2 rounded",children:'"Send quote to client urgent"'}),(0,a.jsx)("p",{className:"text-white bg-[#0d0d0f] px-3 py-2 rounded",children:'"Follow up with bride tomorrow"'})]})]})]})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:i.map(e=>(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"bg-[#161618] rounded-t-lg px-4 py-3 border-t-2 ".concat(e.color),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"font-medium text-white",children:[e.icon," ",e.label]}),(0,a.jsx)("span",{className:"text-xs text-[#9a9a9e] bg-[#0d0d0f] px-2 py-0.5 rounded-full",children:C(e.id).length})]})}),(0,a.jsxs)("div",{className:"bg-[#161618]/50 rounded-b-lg p-2 flex-1 min-h-[200px] space-y-2",children:[C(e.id).map(t=>(0,a.jsxs)("div",{className:"card p-3",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsx)("p",{className:"text-white flex-1",children:t.text}),"max"===t.assignee&&(0,a.jsx)("span",{className:"text-sm ml-2",children:"\uD83E\uDD16"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 mb-2",children:[(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#2a2a2e]",children:t.category}),(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded border ".concat(O(t.priority)),children:t.priority}),t.dueDate&&(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#2a2a2e]",children:E(t.dueDate)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:["max"===t.assignee&&"todo"===e.id&&(0,a.jsx)("button",{onClick:()=>T(t.id,"inprogress"),className:"text-xs px-3 py-1 rounded bg-[#5c7cfa]/20 text-[#5c7cfa] hover:bg-[#5c7cfa]/30 transition-colors",children:"▶️ Start"}),"max"===t.assignee&&"inprogress"===e.id&&(0,a.jsx)("button",{onClick:()=>T(t.id,"done"),className:"text-xs px-3 py-1 rounded bg-[#40c057]/20 text-[#40c057] hover:bg-[#40c057]/30 transition-colors",children:"✅ Done"}),("julius"===t.assignee||"todo"!==e.id&&"inprogress"!==e.id)&&(0,a.jsx)("div",{}),(0,a.jsx)("button",{onClick:()=>I(t.id),className:"p-1 text-[#9a9a9e] hover:text-[#fa5252]",children:"\xd7"})]})]},t.id)),0===C(e.id).length&&(0,a.jsx)("div",{className:"text-center py-8 text-[#9a9a9e] text-sm",children:"No tasks"})]})]},e.id))})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=3612)}),_N_E=e.O()}]);