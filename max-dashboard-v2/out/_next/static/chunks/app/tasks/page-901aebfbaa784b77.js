(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[289],{3612:function(e,t,a){Promise.resolve().then(a.bind(a,6031))},6031:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return l}});var s=a(7437),n=a(2265);let i=[{id:"pending",label:"Awaiting Max",color:"border-[#fa5252]",icon:"⏳"},{id:"todo",label:"To Do",color:"border-[#fab005]",icon:"\uD83D\uDCCB"},{id:"inprogress",label:"In Progress",color:"border-[#5c7cfa]",icon:"\uD83D\uDD04"},{id:"done",label:"Done",color:"border-[#40c057]",icon:"✅"}],r="maxmode-task-changed";function l(){let[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)([{role:"assistant",content:"Hi! I'm Max. When you assign tasks to me, I'll: \n\n1️⃣ Review the task\n2️⃣ Ask clarifying questions if needed\n3️⃣ Wait for your confirmation\n4️⃣ Get to work!\n\nTry assigning a task to me! You can also manage tasks directly from Telegram."}]),[c,o]=(0,n.useState)(""),[d,x]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!0),[p,g]=(0,n.useState)(null),[h,f]=(0,n.useState)(!1),b=(0,n.useRef)(null),D=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=localStorage.getItem("maxmode-tasks-kanban");e&&t(JSON.parse(e)),y()},[]),(0,n.useEffect)(()=>(D.current=setInterval(async()=>{let t=e.filter(e=>"max"===e.assignee&&("pending"===e.status||"inprogress"===e.status));t.length>0&&await j(t)},5e3),()=>{D.current&&clearInterval(D.current)}),[e]);let y=async()=>{try{(await fetch("/api/telegram/poll")).ok&&f(!0)}catch(e){f(!1)}},j=async e=>{try{let e=localStorage.getItem("maxmode-tasks-telegram");if(e){let a=JSON.parse(e),s=Date.now();for(let e of a.filter(e=>s-e.timestamp<1e4))"start"===e.action?t(t=>t.map(t=>t.id===e.taskId?{...t,status:"inprogress"}:t)):"done"===e.action&&t(t=>t.map(t=>t.id===e.taskId?{...t,status:"done"}:t))}}catch(e){console.error("Poll error:",e)}},w=()=>{window.dispatchEvent(new Event(r))};(0,n.useEffect)(()=>{let e=()=>{let e=localStorage.getItem("maxmode-tasks-kanban");e&&t(JSON.parse(e))};return window.addEventListener("storage",e),window.addEventListener(r,e),()=>{window.removeEventListener("storage",e),window.removeEventListener(r,e)}},[]);let N=e=>{t(e),localStorage.setItem("maxmode-tasks-kanban",JSON.stringify(e)),w()},v=async e=>{try{let t="high"===e.priority?"\uD83D\uDD34":"medium"===e.priority?"\uD83D\uDFE1":"\uD83D\uDFE2",a=e.dueDate?"\n\uD83D\uDCC5 Due: ".concat(e.dueDate):"",s='\uD83E\uDD16 *New Task for Max*\n\n"'.concat(e.text,'"\n\n').concat(t," Priority: ").concat(e.priority).concat(a,"\n\uD83D\uDCC1 Category: ").concat(e.category,"\n\nClick ▶️ to start working on this task!"),n=await fetch("/api/telegram/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chatId:"8199918956",text:s,tasks:[e]})});(await n.json()).success&&f(!0)}catch(e){console.error("Telegram notification failed:",e)}},k=e=>{let t=e.toLowerCase(),a="General";for(let[e,s]of Object.entries({wedding:["wedding","bride","groom","venue","vendor","marriage"],business:["quote","invoice","client","lead","sale","proposal","contract"],marketing:["email","social","post","ad","campaign","content"],personal:["personal","family","friend","birthday"]}))if(s.some(e=>t.includes(e))){a=e.charAt(0).toUpperCase()+e.slice(1);break}let s="medium";t.includes("urgent")||t.includes("asap")||t.includes("important")||t.includes("!")?s="high":(t.includes("whenever")||t.includes("sometime"))&&(s="low");let n="julius";(t.includes("max")||t.includes("you"))&&(n="max");let i=null,r=new Date;if(t.includes("tomorrow")){let e=new Date(r);e.setDate(e.getDate()+1),i=e.toISOString().split("T")[0]}else if(t.includes("next week")){let e=new Date(r);e.setDate(e.getDate()+7),i=e.toISOString().split("T")[0]}else t.includes("today")&&(i=r.toISOString().split("T")[0]);let l=t.replace(/tomorrow/g,"").replace(/today/g,"").replace(/next week/g,"").replace(/urgent/g,"").replace(/asap/g,"").replace(/important/g,"").replace(/whenever/g,"").replace(/max/g,"").replace(/you/g,"").replace(/julius/g,"").replace(/remember to /g,"").replace(/remind me to /g,"").replace(/i need to /g,"").replace(/i should /g,"").replace(/can you /g,"").trim();return{text:(l=l.charAt(0).toUpperCase()+l.slice(1))||e,category:a,priority:s,assignee:n,dueDate:i}},S=t=>{let a={id:Date.now().toString()+Math.random().toString(36).substr(2,9),text:t.text||"",status:"max"===t.assignee?"pending":"todo",assignee:t.assignee||"julius",category:t.category||"General",priority:t.priority||"medium",dueDate:t.dueDate||null,createdAt:new Date().toISOString()};return N([a,...e]),"max"===a.assignee&&v(a),a},C=async t=>{if(t.preventDefault(),!c.trim()||d)return;let a=c.trim();o(""),l(e=>[...e,{role:"user",content:a}]),x(!0),await new Promise(e=>setTimeout(e,600));let s=e.find(e=>"max"===e.assignee&&"pending"===e.status);if(s){let t=a.toLowerCase();t.includes("go")||t.includes("yes")||t.includes("do it")||t.includes("proceed")||t.includes("confirmed")?(N(e.map(e=>e.id===s.id?{...e,status:"todo"}:e)),l(e=>[...e,{role:"assistant",content:"\uD83D\uDC4D Got it! Starting work on this task now. I'll let you know when it's done.",taskId:s.id}]),g(s.id)):t.includes("cancel")||t.includes("nevermind")||t.includes("dont")||t.includes("stop")?(N(e.filter(e=>e.id!==s.id)),l(e=>[...e,{role:"assistant",content:"No problem! Task cancelled."}])):(N(e.map(e=>e.id===s.id?{...e,maxNotes:(e.maxNotes||"")+"\n"+a}:e)),l(e=>[...e,{role:"assistant",content:'Got it. Before I start, I have a question: What would you like me to do with this task? Say "go" to proceed or "cancel" to skip.',taskId:s.id}]))}else{let e=k(a);if(e&&e.text){let t=S(e);"max"===t.assignee?l(e=>[...e,{role:"assistant",content:"\uD83D\uDCCB I've noted the task: \"".concat(t.text,'"\n\n').concat("high"===t.priority?"⚡ Priority: High\n":"").concat(t.dueDate?"\uD83D\uDCC5 Due: ".concat(t.dueDate,"\n"):"","Category: ").concat(t.category,"\n\n\uD83D\uDCF1 I've sent this task to your Telegram! Click the button there to start working."),task:t}]):l(e=>[...e,{role:"assistant",content:'Created task for Julius: "'.concat(t.text,'"'),task:t}])}else l(e=>[...e,{role:"assistant",content:'I didn\'t understand. Try: "Follow up with bride tomorrow" or "Send quote to client"'}])}x(!1)},I=t=>{N(e.map(e=>e.id===t?{...e,status:"done"}:e)),l(e=>[...e,{role:"assistant",content:"✅ Task completed!"}]),g(null)},T=t=>e.filter(e=>e.status===t),E=(t,a)=>{N(e.map(e=>e.id===t?{...e,status:a}:e))},O=t=>{N(e.filter(e=>e.id!==t))},A=e=>{switch(e){case"high":return"bg-[#fa5252]/20 text-[#fa5252] border-[#fa5252]";case"medium":return"bg-[#fab005]/20 text-[#fab005] border-[#fab005]";case"low":return"bg-[#40c057]/20 text-[#40c057] border-[#40c057]";default:return"bg-[#2a2a2e] text-[#9a9a9e]"}},M=e=>{if(!e)return"";let t=new Date(e),a=new Date,s=new Date(a);return(s.setDate(s.getDate()+1),t.toDateString()===a.toDateString())?"Today":t.toDateString()===s.toDateString()?"Tomorrow":t.toLocaleDateString("en-US",{month:"short",day:"numeric"})},P=e.filter(e=>"max"===e.assignee&&"pending"===e.status),L=e.filter(e=>"max"===e.assignee&&"inprogress"===e.status);return(0,s.jsxs)("div",{className:"p-4 md:p-6",children:[(0,s.jsxs)("div",{className:"mb-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-white mb-1",children:"Tasks"}),(0,s.jsx)("p",{className:"text-[#9a9a9e]",children:"AI Assistant + Telegram Sync"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs ".concat(h?"bg-[#40c057]/20 text-[#40c057]":"bg-[#fa5252]/20 text-[#fa5252]"),children:[(0,s.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(h?"bg-[#40c057]":"bg-[#fa5252]")}),"Telegram ",h?"Connected":"Offline"]}),(0,s.jsx)("button",{onClick:()=>m(!u),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(u?"bg-[#5c7cfa] text-white":"bg-[#2a2a2e] text-[#9a9a9e]"),children:u?"\uD83D\uDCCB Board":"\uD83D\uDCAC Chat"})]})]}),u?(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"card p-4 flex flex-col h-[600px]",children:[(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4",children:[a.map((e,t)=>(0,s.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,s.jsxs)("div",{className:"max-w-[85%] rounded-lg p-3 ".concat("user"===e.role?"bg-[#5c7cfa] text-white":"bg-[#2a2a2e] text-white"),children:[(0,s.jsx)("p",{className:"whitespace-pre-line text-sm",children:e.content}),e.task&&"max"===e.task.assignee&&(0,s.jsxs)("div",{className:"mt-2 pt-2 border-t border-[#3a3a3e]",children:[(0,s.jsx)("p",{className:"text-xs opacity-70",children:"Assigned to Max"}),(0,s.jsx)("p",{className:"font-medium",children:e.task.text}),"pending"===e.task.status&&(0,s.jsx)("p",{className:"text-xs text-[#fab005] mt-1",children:"⏳ Awaiting confirmation (check Telegram!)"}),"inprogress"===e.task.status&&(0,s.jsx)("p",{className:"text-xs text-[#5c7cfa] mt-1",children:"\uD83D\uDD04 In progress..."})]}),e.taskId&&"assistant"===e.role&&e.content.includes("completed")&&(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)("button",{onClick:()=>I(e.taskId),className:"w-full bg-[#40c057] hover:bg-[#37b24d] text-white py-2 rounded-lg text-sm font-medium transition-colors",children:"Mark Complete"})})]})},t)),d&&(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("div",{className:"bg-[#2a2a2e] rounded-lg p-3",children:(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)("span",{className:"w-2 h-2 bg-[#9a9a9e] rounded-full animate-bounce"}),(0,s.jsx)("span",{className:"w-2 h-2 bg-[#9a9a9e] rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),(0,s.jsx)("span",{className:"w-2 h-2 bg-[#9a9a9e] rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})}),(0,s.jsx)("div",{ref:b})]}),(0,s.jsxs)("form",{onSubmit:C,className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:c,onChange:e=>o(e.target.value),placeholder:P.length>0?'Say "go" or ask a question...':"Describe a task...",className:"flex-1 bg-[#0d0d0f] border border-[#2a2a2e] rounded-lg px-4 py-3 text-white placeholder-[#9a9a9e] focus:outline-none focus:border-[#5c7cfa]"}),(0,s.jsx)("button",{type:"submit",disabled:d||!c.trim(),className:"bg-[#5c7cfa] hover:bg-[#4c6ef5] disabled:opacity-50 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"→"})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:i.map(e=>(0,s.jsxs)("div",{className:"bg-[#161618] rounded-lg px-4 py-3 border-t-2 ".concat(e.color),children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-white",children:T(e.id).length}),(0,s.jsxs)("p",{className:"text-xs text-[#9a9a9e]",children:[e.icon," ",e.label]})]},e.id))}),P.length>0&&(0,s.jsxs)("div",{className:"card p-4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-[#fab005] mb-3",children:"\uD83E\uDD16 Max's Awaiting Tasks"}),(0,s.jsx)("div",{className:"space-y-2",children:P.map(e=>(0,s.jsxs)("div",{className:"bg-[#0d0d0f] rounded-lg p-3",children:[(0,s.jsx)("p",{className:"text-white text-sm",children:e.text}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded border ".concat(A(e.priority)),children:e.priority}),e.dueDate&&(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#2a2a2e]",children:M(e.dueDate)}),(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#fab005]/20 text-[#fab005]",children:"⏳ Pending"})]})]},e.id))})]}),L.length>0&&(0,s.jsxs)("div",{className:"card p-4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-[#5c7cfa] mb-3",children:"\uD83D\uDD04 Max Working On"}),(0,s.jsx)("div",{className:"space-y-2",children:L.map(e=>(0,s.jsxs)("div",{className:"bg-[#0d0d0f] rounded-lg p-3",children:[(0,s.jsx)("p",{className:"text-white text-sm",children:e.text}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded border ".concat(A(e.priority)),children:e.priority}),e.dueDate&&(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#2a2a2e]",children:M(e.dueDate)}),(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#5c7cfa]/20 text-[#5c7cfa]",children:"\uD83D\uDD04 In Progress"})]})]},e.id))})]}),(0,s.jsxs)("div",{className:"card p-4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-[#9a9a9e] mb-3",children:"Try saying:"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsx)("p",{className:"text-white bg-[#0d0d0f] px-3 py-2 rounded",children:'"Max, research wedding venues next week"'}),(0,s.jsx)("p",{className:"text-white bg-[#0d0d0f] px-3 py-2 rounded",children:'"Send quote to client urgent"'}),(0,s.jsx)("p",{className:"text-white bg-[#0d0d0f] px-3 py-2 rounded",children:'"Follow up with bride tomorrow"'})]})]})]})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:i.map(e=>(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("div",{className:"bg-[#161618] rounded-t-lg px-4 py-3 border-t-2 ".concat(e.color),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"font-medium text-white",children:[e.icon," ",e.label]}),(0,s.jsx)("span",{className:"text-xs text-[#9a9a9e] bg-[#0d0d0f] px-2 py-0.5 rounded-full",children:T(e.id).length})]})}),(0,s.jsxs)("div",{className:"bg-[#161618]/50 rounded-b-lg p-2 flex-1 min-h-[200px] space-y-2",children:[T(e.id).map(t=>(0,s.jsxs)("div",{className:"card p-3",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsx)("p",{className:"text-white flex-1",children:t.text}),"max"===t.assignee&&(0,s.jsx)("span",{className:"text-sm ml-2",children:"\uD83E\uDD16"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-1 mb-2",children:[(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#2a2a2e]",children:t.category}),(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded border ".concat(A(t.priority)),children:t.priority}),t.dueDate&&(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#2a2a2e]",children:M(t.dueDate)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:["max"===t.assignee&&"todo"===e.id&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>E(t.id,"inprogress"),className:"text-xs px-3 py-1 rounded bg-[#5c7cfa]/20 text-[#5c7cfa] hover:bg-[#5c7cfa]/30 transition-colors",children:"▶️ Start"}),(0,s.jsx)("button",{onClick:()=>v(t),className:"text-xs px-3 py-1 rounded bg-[#fab005]/20 text-[#fab005] hover:bg-[#fab005]/30 transition-colors",title:"Send notification to Max",children:"\uD83D\uDD14 Notify"})]}),"max"===t.assignee&&"inprogress"===e.id&&(0,s.jsx)("button",{onClick:()=>E(t.id,"done"),className:"text-xs px-3 py-1 rounded bg-[#40c057]/20 text-[#40c057] hover:bg-[#40c057]/30 transition-colors",children:"✅ Done"})]}),(0,s.jsx)("button",{onClick:()=>O(t.id),className:"p-1 text-[#9a9a9e] hover:text-[#fa5252]",children:"\xd7"})]})]},t.id)),0===T(e.id).length&&(0,s.jsx)("div",{className:"text-center py-8 text-[#9a9a9e] text-sm",children:"No tasks"})]})]},e.id))})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=3612)}),_N_E=e.O()}]);