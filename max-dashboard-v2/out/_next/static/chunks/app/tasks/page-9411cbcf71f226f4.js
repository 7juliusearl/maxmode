(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[289],{3612:function(e,t,s){Promise.resolve().then(s.bind(s,6031))},6031:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l}});var a=s(7437),n=s(2265);let i=[{id:"pending",label:"Awaiting Max",color:"border-[#fa5252]",icon:"⏳"},{id:"todo",label:"To Do",color:"border-[#fab005]",icon:"\uD83D\uDCCB"},{id:"inprogress",label:"In Progress",color:"border-[#5c7cfa]",icon:"\uD83D\uDD04"},{id:"done",label:"Done",color:"border-[#40c057]",icon:"✅"}];function l(){let[e,t]=(0,n.useState)([]),[s,l]=(0,n.useState)([]),[r,c]=(0,n.useState)(""),[d,o]=(0,n.useState)(!1),[u,x]=(0,n.useState)(!1),[m,p]=(0,n.useState)(null),[g,h]=(0,n.useState)(!1),f=(0,n.useRef)(null),b=(0,n.useRef)(null);(0,n.useEffect)(()=>{D()},[]);let D=async()=>{try{let e=await fetch("/api/tasks/get"),s=await e.json();s.success&&s.tasks&&(t(s.tasks),h(!0))}catch(s){let e=localStorage.getItem("maxmode-tasks-kanban");e&&t(JSON.parse(e))}},y=async e=>{t(e);try{await fetch("/api/tasks/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tasks:e})}),h(!0)}catch(e){console.error(e)}localStorage.setItem("maxmode-tasks-kanban",JSON.stringify(e)),window.dispatchEvent(new Event("maxmode-task-changed"))},j=async e=>{let t="high"===e.priority?"\uD83D\uDD34":"medium"===e.priority?"\uD83D\uDFE1":"\uD83D\uDFE2",s=e.dueDate?"\n\uD83D\uDCC5 Due: ".concat(e.dueDate):"",a='\uD83E\uDD16 *New Task for Max*\n\n"'.concat(e.text,'"\n\n').concat(t," Priority: ").concat(e.priority).concat(s,"\n\uD83D\uDCC1 Category: ").concat(e.category,"\n\nClick ▶️ to start!");try{await fetch("/api/telegram/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chatId:"8199918956",text:a,tasks:[e]})})}catch(e){console.error("Telegram error:",e)}},N=e=>{let t=e.toLowerCase(),s="General";for(let[e,a]of Object.entries({wedding:["wedding","bride","groom","venue","vendor"],business:["quote","invoice","client","lead","sale","proposal"],marketing:["email","social","post","ad","campaign","content"],personal:["personal","family","friend","birthday"]}))if(a.some(e=>t.includes(e))){s=e.charAt(0).toUpperCase()+e.slice(1);break}let a="medium";t.includes("urgent")||t.includes("asap")||t.includes("important")?a="high":(t.includes("whenever")||t.includes("sometime"))&&(a="low");let n="julius";(t.includes("max")||t.includes("you"))&&(n="max");let i=null,l=new Date;if(t.includes("tomorrow")){let e=new Date(l);e.setDate(e.getDate()+1),i=e.toISOString().split("T")[0]}else if(t.includes("next week")){let e=new Date(l);e.setDate(e.getDate()+7),i=e.toISOString().split("T")[0]}else t.includes("today")&&(i=l.toISOString().split("T")[0]);let r=t.replace(/tomorrow|today|next week|urgent|asap|important|whenever|sometime|max|you|julius|remember to |remind me to |i need to |i should |can you /g,"").replace(/\s+/g," ").trim();return{text:(r=r.charAt(0).toUpperCase()+r.slice(1))||e,category:s,priority:a,assignee:n,dueDate:i}},w=t=>{let s={id:Date.now().toString()+Math.random().toString(36).substr(2,9),text:t.text||"",status:"max"===t.assignee?"pending":"todo",assignee:t.assignee||"julius",category:t.category||"General",priority:t.priority||"medium",dueDate:t.dueDate||null,createdAt:new Date().toISOString()};return y([s,...e]),"max"===s.assignee&&j(s),s},v=async t=>{if(t.preventDefault(),!r.trim()||d)return;let s=r.trim();c(""),l(e=>[...e,{role:"user",content:s}]),o(!0),await new Promise(e=>setTimeout(e,600));let a=e.find(e=>"max"===e.assignee&&"pending"===e.status),n=s.toLowerCase();if(a)n.includes("go")||n.includes("yes")||n.includes("proceed")||n.includes("confirmed")?(y(e.map(e=>e.id===a.id?{...e,status:"todo"}:e)),l(e=>[...e,{role:"assistant",content:"\uD83D\uDC4D Got it! Starting work now.",taskId:a.id}])):n.includes("cancel")||n.includes("nevermind")||n.includes("dont")||n.includes("stop")?(y(e.filter(e=>e.id!==a.id)),l(e=>[...e,{role:"assistant",content:"No problem! Task cancelled."}])):l(e=>[...e,{role:"assistant",content:'Got it. Say "go" to proceed or "cancel" to skip.',taskId:a.id}]);else{let e=N(s);if(e&&e.text){let t=w(e);l(s=>[...s,{role:"assistant",content:"max"===e.assignee?"\uD83D\uDCCB Task sent to your Telegram! Check your DM.":'Created: "'.concat(t.text,'"'),task:t}])}else l(e=>[...e,{role:"assistant",content:'Try: "Follow up with bride tomorrow"'}])}o(!1)},k=t=>e.filter(e=>e.status===t),S=(t,s)=>y(e.map(e=>e.id===t?{...e,status:s}:e)),C=t=>y(e.filter(e=>e.id!==t)),T=e=>{switch(e){case"high":return"bg-[#fa5252]/20 text-[#fa5252]";case"medium":return"bg-[#fab005]/20 text-[#fab005]";case"low":return"bg-[#40c057]/20 text-[#40c057]";default:return"bg-[#2a2a2e] text-[#9a9a9e]"}},O=e=>{if(!e)return"";let t=new Date(e),s=new Date;return t.toDateString()===s.toDateString()?"Today":t.toDateString()===new Date(s.setDate(s.getDate()+1)).toDateString()?"Tomorrow":t.toLocaleDateString("en-US",{month:"short",day:"numeric"})},I=e.filter(e=>"max"===e.assignee&&"pending"===e.status),E=e.filter(e=>"max"===e.assignee&&"inprogress"===e.status);return(0,a.jsxs)("div",{className:"p-4 md:p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-white mb-1",children:"Tasks"}),(0,a.jsxs)("p",{className:"text-[#9a9a9e]",children:[e.length," total • ",g?"☁️ Synced":"\uD83D\uDCF1 Local"]})]}),(0,a.jsx)("button",{onClick:()=>{x(!u),u||setTimeout(()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.focus()},100)},className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(u?"bg-[#2a2a2e] text-[#9a9a9e]":"bg-[#5c7cfa] text-white"),children:u?"\uD83D\uDCCB Board":"\uD83D\uDCAC Chat"})]}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-6",children:i.map(e=>(0,a.jsxs)("div",{className:"bg-[#161618] rounded-lg px-3 py-2 border-t-2 ".concat(e.color),children:[(0,a.jsx)("p",{className:"text-xl font-bold text-white",children:k(e.id).length}),(0,a.jsxs)("p",{className:"text-xs text-[#9a9a9e] truncate",children:[e.icon," ",e.label]})]},e.id))}),u?(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"card p-4 flex flex-col h-[500px]",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-3 mb-3",children:[0===s.length?(0,a.jsxs)("div",{className:"text-center py-12 text-[#9a9a9e]",children:[(0,a.jsx)("p",{className:"text-lg mb-2",children:"\uD83D\uDCAC Chat with Max"}),(0,a.jsx)("p",{className:"text-sm",children:"Describe a task and I'll create it!"}),(0,a.jsx)("p",{className:"text-xs mt-4 opacity-50",children:'Try: "Follow up with bride tomorrow"'})]}):s.map((e,t)=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,a.jsx)("div",{className:"max-w-[85%] rounded-lg p-3 ".concat("user"===e.role?"bg-[#5c7cfa] text-white":"bg-[#2a2a2e] text-white"),children:(0,a.jsx)("p",{className:"text-sm",children:e.content})})},t)),d&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-[#2a2a2e] rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-[#9a9a9e] rounded-full animate-bounce"}),(0,a.jsx)("span",{className:"w-2 h-2 bg-[#9a9a9e] rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),(0,a.jsx)("span",{className:"w-2 h-2 bg-[#9a9a9e] rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})}),(0,a.jsx)("div",{ref:f})]}),(0,a.jsxs)("form",{onSubmit:v,className:"flex gap-2",children:[(0,a.jsx)("input",{ref:b,type:"text",value:r,onChange:e=>c(e.target.value),placeholder:"Describe a task...",className:"flex-1 bg-[#0d0d0f] border border-[#2a2a2e] rounded-lg px-4 py-3 text-white placeholder-[#9a9a9e] focus:outline-none focus:border-[#5c7cfa]"}),(0,a.jsx)("button",{type:"submit",disabled:d||!r.trim(),className:"bg-[#5c7cfa] hover:bg-[#4c6ef5] disabled:opacity-50 text-white px-6 rounded-lg",children:"→"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[I.length>0&&(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-[#fab005] mb-3",children:"⏳ Awaiting Max"}),I.map(e=>(0,a.jsxs)("div",{className:"bg-[#0d0d0f] rounded-lg p-3 mb-2",children:[(0,a.jsx)("p",{className:"text-white text-sm",children:e.text}),(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded ".concat(T(e.priority)),children:e.priority}),e.dueDate&&(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#2a2a2e]",children:O(e.dueDate)})]})]},e.id))]}),E.length>0&&(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-[#5c7cfa] mb-3",children:"\uD83D\uDD04 Max Working On"}),E.map(e=>(0,a.jsx)("div",{className:"bg-[#0d0d0f] rounded-lg p-3 mb-2",children:(0,a.jsx)("p",{className:"text-white text-sm",children:e.text})},e.id))]})]})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:i.map(e=>(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"bg-[#161618] rounded-t-lg px-4 py-3 border-t-2 ".concat(e.color),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"font-medium text-white",children:[e.icon," ",e.label]}),(0,a.jsx)("span",{className:"text-xs bg-[#0d0d0f] px-2 py-0.5 rounded-full",children:k(e.id).length})]})}),(0,a.jsxs)("div",{className:"bg-[#161618]/50 rounded-b-lg p-2 flex-1 min-h-[300px] space-y-2",children:[k(e.id).map(t=>(0,a.jsxs)("div",{className:"card p-3",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsx)("p",{className:"text-white flex-1",children:t.text}),"max"===t.assignee&&(0,a.jsx)("span",{className:"ml-2",children:"\uD83E\uDD16"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 mb-2",children:[(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#2a2a2e]",children:t.category}),(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded ".concat(T(t.priority)),children:t.priority}),t.dueDate&&(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-[#2a2a2e]",children:O(t.dueDate)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:["max"===t.assignee&&"todo"===e.id&&(0,a.jsx)("button",{onClick:()=>S(t.id,"inprogress"),className:"text-xs px-3 py-1 rounded bg-[#5c7cfa]/20 text-[#5c7cfa]",children:"▶️ Start"}),"max"===t.assignee&&"inprogress"===e.id&&(0,a.jsx)("button",{onClick:()=>S(t.id,"done"),className:"text-xs px-3 py-1 rounded bg-[#40c057]/20 text-[#40c057]",children:"✅ Done"}),(0,a.jsx)("button",{onClick:()=>C(t.id),className:"p-1 text-[#9a9a9e] hover:text-[#fa5252]",children:"\xd7"})]})]},t.id)),0===k(e.id).length&&(0,a.jsx)("div",{className:"text-center py-8 text-[#9a9a9e] text-sm",children:"No tasks"})]})]},e.id))})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=3612)}),_N_E=e.O()}]);